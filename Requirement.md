# API需求分类

## 功能分类

| 序号 | API分类       | 功能描述                                                                 | 工具                                |
|------|---------------|--------------------------------------------------------------------------|------------------------------------|
| 1    | 获取信息       | 提取图片及视频的基本信息（格式、尺寸、分辨率、色彩模式等）及元数据（EXIF、IPTC） | `ffprobe`, `mediainfo`, `ImageMagick` |
| 2    | 文件比较       | 分析图片间的相似性，计算SSIM或PSNR                                       | `ffprobe`, `ImageMagick`           |
| 3    | 转换           | 转码为不同格式（HEIC、AVIF、WebP、GIF等）                                 | `ffmpeg`, `ImageMagick`, `gif2webp` |
| 4    | 压缩           | 图片有损/无损压缩，减少文件大小                                           | `ffmpeg`, `ImageMagick`, `gifsicle`, `oxipng` |
| 5    | 设置与调整     | 裁剪、缩放、旋转、翻转、拼接、色彩优化等                                  | `ffmpeg`, `ImageMagick`, `jpgiccplus` |
| 6    | 抽帧           | 从动图或视频中抽取静态帧                                                | `ffmpeg`, `ImageMagick`           |
| 7    | 文本与水印     | 添加文字/水印，支持样式与位置设置；删除水印                               | `ImageMagick`, `delogo`           |
| 8    | 滤镜与特效     | 应用滤镜效果（如晕影、模糊、油画等）                                      | `ImageMagick`                     |
| 9    | AI增强         | 使用AI技术增强图片清晰度、亮度，对人像智能修饰                            | `ZoomAI`                          |
| 10   | 高级功能       | 任务管理（上下文管理、任务串行与并行执行、日志记录）                      | -                                 |

---

# API需求列表

## 通用要求
- 支持单个/多个文件处理  
- 支持同步/异步调用  
- 支持多任务并行处理  
- 支持前后任务叠加操作  

## API接口设计

### 1. 获取信息

| API名称                   | 说明                               | 参数                            | 作用场景                           |
|--------------------------|------------------------------------|--------------------------------|-----------------------------------|
| `getBasicInfo(path, params)` | 获取图片基本信息                     | `path`: 图片路径；`params`: 属性 | 转码前获取准确信息                   |
| `getMetadata(path)`         | 获取元数据（EXIF、XMP、IPTC）       | `path`: 图片路径                | 提取元数据用于分类管理               |
| `isAnimated(path)`         | 判断是否为动图                      | `path`: 图片路径                | 判断是否抽帧或转码                   |
| `getFrames(path)`          | 获取动图帧数                        | `path`: 图片路径                | 判断动图帧数                        |
| `getResolution(path)`      | 获取分辨率（宽x高，DPI）            | `path`: 图片路径                | 压缩方式选择，转码时间预估           |

### 2. 文件比较

| API名称                     | 说明                            | 参数                           | 作用场景                        |
|----------------------------|---------------------------------|--------------------------------|--------------------------------|
| `compareImages(img1, img2)` | 比较两张图片的SSIM或PSNR         | `img1`: 图片1路径；`img2`: 图片2路径 | 转码效果对比                     |
| `rotateImageToOrientation(path, orientation)` | 逐像素比较两张图片             | `path`: 图片路径；`orientation`: 方向 | 精准分析内容差异                 |

### 3. 转换

| API名称                       | 说明                       | 参数                                | 作用场景                    |
|------------------------------|----------------------------|------------------------------------|---------------------------|
| `convertTo(source, target, params)` | 转换图片格式               | `source`: 来源路径；`target`: 目标格式；`params`: 附加参数 | 通用格式转换               |
| `convertToWebP(source, target, params)` | 转WebP格式            | 同上                               | 快捷格式转换               |
| `convertToGIF(source, target, params)` | 转GIF格式             | 同上                               | 快捷格式转换               |

### 4. 压缩

| API名称                       | 说明                        | 参数                                | 作用场景                    |
|------------------------------|-----------------------------|------------------------------------|---------------------------|
| `compressImage(source, target, params)` | 压缩图片（有损/无损）    | `source`: 来源路径；`target`: 压缩路径；`params`: 参数 | 文件大小优化               |
| `losslessCompress(path)`        | 无损压缩                   | `path`: 图片路径                   | 保留原质量压缩             |

### 5. 设置与调整

| API名称                   | 说明                            | 参数                              | 作用场景                  |
|--------------------------|---------------------------------|----------------------------------|-------------------------|
| `cropImage(source, target, params)` | 裁剪图片                  | `source`: 来源路径；`params`: 区域参数 | 定位裁剪                |
| `resizeImage(source, target, params)` | 缩放图片                 | `source`: 来源路径；`params`: 尺寸 | 按需调整大小             |

### 6. 抽帧

| API名称                      | 说明                          | 参数                            | 作用场景                |
|-----------------------------|-------------------------------|--------------------------------|-----------------------|
| `extractFrame(path, param)`   | 抽取视频/动图帧              | `path`: 文件路径；`param`: 帧号 | 内容分析、帧优化        |

### 7. 文本与水印

| API名称                        | 说明                        | 参数                           | 作用场景               |
|--------------------------------|-----------------------------|--------------------------------|----------------------|
| `addText(source, target, text, params)` | 添加文字               | `text`: 内容；`params`: 样式 | 图片标注或水印        |
| `addWatermark(path, watermarkPath, position)` | 添加水印           | `watermarkPath`: 水印路径；`position`: 位置 | 防盗用                |

### 8. 滤镜与特效

| API名称                         | 说明                        | 参数                               | 作用场景                |
|--------------------------------|-----------------------------|-----------------------------------|-----------------------|
| `applyFilter(source, target, filterType)` | 应用滤镜            | `filterType`: 滤镜类型             | 图像增强               |
| `applyEffect(source, target, effectType)` | 添加特效            | `effectType`: 特效类型             | 特效增强               |

### 9. AI增强与擦除

| API名称                   | 说明                          | 参数                            | 作用场景                |
|--------------------------|-------------------------------|--------------------------------|-----------------------|
| `aiEnhance(source, target, model)` | AI增强                 | `model`: 增强模型               | 清晰度、亮度提升        |
| `eraseArea(path, x, y, width, height)` | 擦除区域             | `x, y, width, height`: 区域坐标 | 去除水印、修图          |

### 10. 高级功能

| API名称                | 说明                          | 参数                      | 作用场景                  |
|-----------------------|-------------------------------|--------------------------|-------------------------|
| `startTask(taskList)`   | 启动任务链，支持并行/串行    | `taskList`: 任务列表      | 任务批处理               |
| `getTaskStatus(taskId)` | 查询任务状态                 | `taskId`: 任务ID         | 任务监控                |
